env:
  BACKEND_CONFIG: "backends\\backend.nonprod"
  VARFILE: "envs\\nonprod"

args:

# Terraform tasks
version: '3'
tasks:
  install-required-tools:
    desc: Install required tools
    cmds:
      - echo 'Please install terraform, terraform-docs, tflint binaries before use with Chocolatey or Winget'
  lint: 
    desc: Lint terraform files
    cmds:
      - tflint
  docs:
    desc: Generate terraform docs
    cmds:
      - terraform-docs markdown table . > terrraform.md
  init:
    desc: Terraform init
    cmds:
      - terraform init -backend-config="{{.BACKEND_CONFIG}}.config"
  validate:
    desc: Terraform validate
    cmds:
      - terraform validate
  plan:
    desc: Terraform plan
    cmds:
      - terraform plan -var-file="{{.VARFILE}}.tfvars"
  apply:
    desc: Terraform apply
    cmds:
      - terraform apply -var-file="{{.VARFILE}}.tfvars"
  destroy:
    desc: Terraform destroy
    cmds:
      - terraform destroy -var-file="{{.VARFILE}}.tfvars"
